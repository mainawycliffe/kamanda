# whenever a new release is done, this github actions will generate and update
# the docs.
name: npm publish

on:
  release:
    types: [created]
  push:
    branches: [master]

jobs:
  docsGen:
    name: Generate Documentation For New Release
    runs-on: ubuntu-latest
    steps:
      - name: Set up Go 1.13
        uses: actions/setup-go@v1
        with:
          go-version: 1.13
        id: go
      - name: Check out code into the Go module directory
        uses: actions/checkout@v2
      - name: Get dependencies
        run: go get -v -t -d ./...
      - name: Generate Documentation
        run: go run main.go docsGen
        # commit the changes
      - uses: stefanzweifel/git-auto-commit-action@v4.1.5
        with:
          commit_message: Update Kamanda Documentation [CI]
          commit_user_name: Kamanda Bot
          commit_user_email: bot@kamanda.dev
          commit_author: Kamanda Bot <bot@kamanda.dev>
        # in future, build and deploy the site
